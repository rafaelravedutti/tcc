/* Iterates over an image on GPU architectures */
fn iterate(img : image_struct, body: fn(int,int) -> ()) -> () {
  let acc = cuda_accelerator(0);
  let grid = (img.width, img.height, 1);
  let block = (1, 1, 1);

  with acc.exec(grid, block) @{
    let x = acc.bidx() * acc.bdimx() + acc.tidx();
    let y = acc.bidy() * acc.bdimy() + acc.tidy();

    body(x, y);
  }
}

fn exp(a : f32) -> f32 {
  cuda_intrinsics.expf(a)
}
